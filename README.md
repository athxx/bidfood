# Bidfood grpc Microservices

## Overview

this markdown only for question 1, ratelimter part please view this file
[ratelimiter/README.md](ratelimiter/README.md)

### Key Features

- **Microservices Architecture** - Separate gRPC core service and HTTP API gateway
- **Complete CRUD Operations** - Create, read, update, delete products
- **Advanced Querying** - Pagination and name-based filtering
- **Thread-Safe Storage** - In-memory storage with proper synchronization
- **Graceful Shutdown** - Context-based cleanup and resource management
- **Comprehensive Testing** - Unit tests with mocks and integration tests
- **Developer-Friendly** - Rich Makefile with development commands

## Tech Stack

### Libraries

Here, I’ve tried to minimize the use of external libraries to demonstrate a basic microservice architecture.

- `github.com/go-chi/chi/v5` for routing and handling HTTP requests
- `github.com/google/uuid` for generating unique identifiers
- `google.golang.org/grpc` for implementing gRPC services
- `google.golang.org/protobuf` for defining and working with protocol buffers

## Architecture

```
┌─────────────────┐    HTTP     ┌─────────────────┐    gRPC     ┌─────────────────┐
│   Client/Web    │ ◄────────── │   bidapi        │ ◄────────── │   bidrpc        │
│   Application   │    REST     │  (HTTP Gateway) │   Internal  │ (Core Service)  │
└─────────────────┘             └─────────────────┘             └─────────────────┘
                                      :8080                           :9000
```

### File structure

```
├── answers
│   ├── CODEREVIEW.md
│   ├── DESIGN.md
│   └── structs.png
├── bidapi
│   ├── cmd
│   │   ├── main.go                          // bidapi implementation uses chi router for HTTP requests
│   │   └── main_test.go                     // bidapi tests
│   └── internal
│       ├── hdl                              // handlers
│       │   ├── dto.go                       // data transfer objects
│       │   ├── hdl_product.go               // product handler
│       │   └── helper.go                    // helper functions
│       └── rpc
│           └── product.go                   // product RPC client
├── bidrpc
│   ├── cmd
│   │   └── main.go
│   ├── bidrpcproto
│   │   ├── product_grpc.pb.go               // product GRPC client, auto-generated by protoc
│   │   ├── product.pb.go                    // product pb file, auto-generated by protoc
│   │   └── product.proto                    // product GRPC proto
│   ├── cmd_proto_gen.sh
│   └── internal
│       ├── biz
│       │   ├── product.go                   // product business logic
│       │   ├── product_test.go              // product business logic test
│       ├── data
│       │   ├── product.go                   // product data layer
│       │   └── product_test.go              // product data layer test
│       └── service
│           └── product.go                   // product service layer
├── go.mod
├── go.sum
├── Makefile                         // Makefile for building and testing the project
├── ratelimiter
│   ├── main.go                      // ratelimiter implementation uses two different approaches.
│   └── readme.md                    // ratelimiter description
├── README.md
├── test_api.sh                      // Test HTTP API, need to install `curl`
├── test.http                        // Test HTTP API, in vscode install `REST Client` plugin
└── test_rpc.sh                      // Test RPC API, need to install `grpcurl`

15 directories, 28 files
```

## Requirements

- **Go Version**: 1.24.1 +
- **Protoc Version**: 3.15+
- **Dependencies** : Make

## How to run ?

### install dependencies

- 1. install `go`, you can install golang by using `mise`
- 2. install `protoc`
- 3. after install `go` and `protoc`, run `make deps` to install dependencies

**please run both api gateway and rpc at the same time, you need to run them in separate terminals.**

### Run in Windows

blow command are for Linux or macOS, if you using `Windows` os, please see this document :

## [Run-on-Windows.md](Run-on-Windows.md)

---

### Run api gateway

```bash
make api
```

### Run rpc service

```bash
# run rpc server
make rpc
```

### generated go files from protobuf file(if you change proto file)

```bash
make proto
```

## How to test ?

### unit test

```sh
make test
```

### api test

```sh
make test-api
```

### rpc test

```sh
make test-rpc
```
